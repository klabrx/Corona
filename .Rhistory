as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
dashdat$X1
dashdat %>% t()
dashdat <- dashdat %>% t()
dashdat <- dashdat %>% t()
names
names(dashdat)
colnames(dashdat)
paste0(dashdat[1,],"-",dashdat[2,])
paste0(dashdat[2,],"-",dashdat[1,])
paste0(dashdat[2,],"-",dashdat[1,])
library(stringr)
paste0(str_pad(dashdat[2,]5,side=c("left"), pad="0"),"-",dashdat[1,])
paste0(str_pad(as.char(dashdat[2,]5,side=c("left"), pad="0"),"-",dashdat[1,])
paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
colnames(dashdat)
paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
# dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat[-(1:2),]
dashdat <- dashdat[-(1:2),]
colnames(dashdat[,1])
colnames(dashdat[,2])
names(dashdat)
names(dashdat[1])
names(dashdat[1]) <- c("Datum")
names(dashdat[1])
colnames(dashdat[1])
colnames(dashdat[1]) <- c("Datum")
colnames(dashdat[1])
dashdat$`0LKNR-LK`
dashdat$Datum <- as.Date(dashdat$`0LKNR-LK`)
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat$Datum
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
# dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%  pivot_longer(names_to = "Datum", values_to = "Inzidenz")
dashdat.pivot <- dashdat %>%  pivot_longer(cols=!Datum, names_to = "Datum", values_to = "Inzidenz")
dashdat %>% lastcol()
dashdat %>% select(lastcol())
dashdat %>% select(last_col())
dashdat %>% pivot_longer(!Datum, names_to = "Kreis", values_to = "Inzidenz")
dashdat %>% select(-1) %>% pivot_longer(!Datum, names_to = "Kreis", values_to = "Inzidenz")
dashdat %>% select(-1) %>% pivot_longer(!Datum, names_to = "Kreis", values_to = "Inzidenz") %>% mutate(Inzidenz = round(as.numeric(Inzidenz),1))
dashdat.pivot <- ddashdat %>% select(-1) %>% pivot_longer(!Datum, names_to = "Kreis", values_to = "Inzidenz") %>% mutate(Inzidenz = round(as.numeric(Inzidenz),1))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1))
dashdat.pivot %>% head()
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
# dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"))
View(dashdat.pivot)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
# dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="-")
View(dashdat.pivot)
dashdat.pivot %>% filter(Kreis=="SK Passau")
dashdat.pivot %>% filter(Kreis=="SK Passau") %>% tail()
dashdat.pivot %>% filter(Kreis=="LK Passau") %>% tail()
dashdat.pivot %>% filter(Kreis=="LK Passau") %>% ggplot(aes(x=Datum, y= Inzidenz)) + geom_line()
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = variable, linetype = variable)) +
scale_color_manual(values = c("darkred", "steelblue"))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis, linetype = Kreis)) +
scale_color_manual(values = c("darkred", "steelblue"))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis, linetype = Kreis))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz)) +
geom_line(aes(color = Kreis))
dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot %>% dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
# names(dashdat) <- dashdat[1,]
# dashdat <- dashdat %>% filter(LKNR != "LKNR") %>% pivot_longer(!LK:LKNR, names_to = "Datum", values_to = "Inzidenz")
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="-")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line() +
scale_color_viridis(discrete = TRUE)
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","SK Landshut")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"#",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="#")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau","SK Passau","SK Landshut")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"#",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="#")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau",
"SK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau",
"SK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"#",dashdat[1,])
View(dashdat)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"ยง",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="ยง")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau",
"SK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"ยง",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep="ยง", extra="merge")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau",
"SK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"-",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5, extra="merge")
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNR-LK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5, extra="merge")
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNRLK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5, extra="merge")
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("LK Passau",
"SK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNRLK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5)
dashdat <- read_excel(destfile, sheet=7, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
as.excel.date=function(x) as.Date(x,origin='1900-01-01')-2
dashdat[which(nchar(dashdat$X1) == 10),]$X1 <- as.Date(parse_date_time(dashdat[which(nchar(dashdat$X1) == 10),]$X1, c('d.m.y')))
dashdat[which(nchar(dashdat$X1) == 11),]$X1 <- dashdat[which(nchar(dashdat$X1) == 11),]$X1 %>% as.numeric() %>% as.excel.date()
colnames(dashdat) <- paste0(str_pad(dashdat[2,],5,side=c("left"), pad="0"),"",dashdat[1,])
dashdat <- dashdat[-(1:2),]
dashdat$Datum <- as.Date(as.numeric(dashdat$`0LKNRLK`))
dashdat.pivot <- dashdat %>%
select(-1) %>%
pivot_longer(!Datum,
names_to = "Kreis",
values_to = "Inzidenz") %>%
mutate(Inzidenz = round(as.numeric(Inzidenz),1)) %>%
separate(Kreis,c("AGS","Kreis"), sep=5)
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis)) +
geom_line()
dashdat.plot
dashdat.pivot$mysize <- rep(2, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 4
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line()
dashdat.plot
dashdat.pivot$mysize <- rep(1, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 2
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line()
dashdat.plot
dashdat.pivot$mysize <- rep(1, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 2
dashdat.pivot$mysize <- rep(1, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 2
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line()
scale_size(range = c(2, 4), guide="none")
dashdat.plot
dashdat.pivot$mysize <- rep(1, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 2
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line() +
scale_size(range = c(1, 3), guide="none")
dashdat.plot
dashdat.pivot$mysize <- rep(0.5, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 1
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line() +
scale_size(range = c(1, 3), guide="none")
dashdat.plot
dashdat.pivot$mysize <- rep(0.5, nrow(dashdat.pivot))
dashdat.pivot$mysize[dashdat.pivot$AGS=="09262"] <- 1
dashdat.plot <- dashdat.pivot %>% filter(Kreis %in% c("SK Passau",
"LK Passau",
"SK Landshut",
"LK Freyung-Grafenau",
"LK Rottal-Inn",
"LK Deggendorf")) %>%
ggplot(aes(x = Datum, y = Inzidenz, group=Kreis, color=Kreis, size=mysize)) +
geom_line() +
scale_size(range = c(0.5, 1), guide="none")
dashdat.plot
rmarkdown::render(
input = "Report.rmd",
envir = .GlobalEnv,
output_file = paste0("./html/RKI_Report_09262-", Sys.Date() - 1, ".html"),
output_dir = paste0("html/", "09262")
)
rmarkdown::render(
input = "FlexDash.rmd",
envir = .GlobalEnv,
output_file = paste0("./html/Flexdashboard-", Sys.Date() - 1, ".html"),
output_dir = paste0("html/", "09262")
)
warnings()
BLdat <- read_excel(destfile, sheet=5, skip=4, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
BLdat <- read_excel(destfile, sheet=5, skip=3, col_names = FALSE) %>% select(-1) %>% t()  %>% data.frame()
View(BLdat)
BLdat <- read_excel(destfile, sheet=5, skip=2, col_names = TRUE) %>% t()  %>% data.frame()
BLdat <- read_excel(destfile, sheet=5, skip=3, col_names = TRUE) %>% t()  %>% data.frame()
BLdat <- read_excel(destfile, sheet=5, skip=3, col_names = TRUE) %>% t()  %>% data.frame()
BLdat <- read_excel(destfile, sheet=5, skip=2, col_names = TRUE) %>% t()  %>% data.frame()
BLdat <- read_excel(destfile, sheet=5, skip=2, col_names = TRUE)   %>% data.frame()
colnames(BLdat)
colnames(Bundesland[1])
colnames(BLdat[1])
colnames(BLdat[1]) <- "Bundesland"
colnames(BLdat[1]) <- c("Bundesland")
